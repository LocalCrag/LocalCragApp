<ng-container *transloco="let t">
  <p-skeleton width="100%" height="2rem" *ngIf="gradeDistributionEmpty"></p-skeleton>

  <ng-container *ngIf="!gradeDistributionEmpty">
    <div class="grade-distribution-stack hidden sm:flex mb-3" *ngFor="let data of stackChartData">
      <div class="level-total">
        {{ data.total - data.data.projects }}
        {{ stackChartData.length > 1 ? data.gradeScale : "" }}
        {{ t("lines") }}:
      </div>
      <ng-template *ngFor="let count of data.brackets; index as i">
          <div
            class="level-{{ i == data.brackets.length - 1 ? 'max' : i}}"
            [style.width]="data.total > 0 ? (data.data.brackets[i] / data.total) * 100 + '%' : '20%'"
          >
            <p-badge [value]="count | toString" styleClass="neutral-badge"></p-badge>
            {{ data.bracketLabels[i] }}
          </div>
      </ng-template>
      <div
        class="level-projects"
        [style.width]="data.total > 0 ? (data.data.projects / data.total) * 100 + '%' : '20%'"
      >
        <p-badge [value]="data.data.projects | toString" styleClass="neutral-badge"></p-badge>
        {{ t("leveledGradeDistributionLevelProjects") }}
      </div>
    </div>

    <div
      class="grade-distribution-tags flex align-items-center gap-3 sm:hidden mb-3"
      *ngFor="let data of stackChartData"
    >
      <p-tag styleClass="level-total">
        <p-badge
          [value]="data.total - data.data.projects"
          styleClass="neutral-badge"
        ></p-badge>
        {{ stackChartData.length > 1 ? data.gradeScale : "" }}
        {{ t("lines") }}:
      </p-tag>
      <ng-template *ngFor="let count of data.brackets; index as i">
        <p-tag styleClass="level-{{ i == data.brackets.length - 1 ? 'max' : i}}">
          <p-badge [value]="data.data.brackets[i] | toString" styleClass="neutral-badge"></p-badge>
          {{ data.bracketLabels[i] }}
        </p-tag>
      </ng-template>
      <p-tag styleClass="level-projects">
        <p-badge [value]="data.data.projects | toString" styleClass="neutral-badge"></p-badge>
        {{ t("leveledGradeDistributionLevelProjects") }}
      </p-tag>
    </div>
  </ng-container>
</ng-container>
