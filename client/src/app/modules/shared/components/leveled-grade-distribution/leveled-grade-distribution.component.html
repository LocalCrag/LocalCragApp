<ng-container *transloco="let t">
  @if (gradeDistributionEmpty) {
    <p-skeleton
      width="100%"
      height="2rem"
    ></p-skeleton>
  }

  @if (!gradeDistributionEmpty) {
    @for (data of stackChartData; track data) {
      <div class="mb-3">
        <p-meterGroup
          [value]="data.meterValues"
          [min]="0"
          [max]="data.total - data.projects - data.ungraded"
          >
          <ng-template #label>
            <div
              class="p-metergroup-labels p-component p-metergroup-labels-horizontal flex gap-3"
              >
              @if (data.total - data.projects > 0) {
                <div
                  class="p-metergroup-label font-bold"
                  >
                  {{ data.total - data.projects }}
                  {{ stackChartData.length > 1 ? data.gradeScale : "" }}
                  {{ t("lines") }}:
                </div>
              }
              @for (meterValue of data.meterValues; track meterValue) {
                <div
                  class="p-metergroup-label"
                  >
                  <p-tag
                    value="{{ meterValue.value }} {{ meterValue.label }}"
                [style]="{
                  backgroundColor: meterValue.color,
                  color: textColor(meterValue.color, '#2e3132'),
                }"
                    />
                </div>
              }
              @if (data.ungraded > 0) {
                <div class="p-metergroup-label">
                  <p-tag
                value="{{ data.ungraded }} {{
                  t('leveledGradeDistributionUngraded')
                }}"
                [style]="{
                  backgroundColor: '#e5e7eb',
                  color: textColor('#e5e7eb', '#2e3132'),
                }"
                    />
                </div>
              }
              @if (data.projects > 0) {
                <div class="p-metergroup-label">
                  <p-tag
                value="{{ data.projects }} {{
                  t('leveledGradeDistributionProjects')
                }}"
                [style]="{
                  backgroundColor: '#e5e7eb',
                  color: textColor('#e5e7eb', '#2e3132'),
                }"
                    />
                </div>
              }
            </div>
          </ng-template>
        </p-meterGroup>
      </div>
    }
  }
</ng-container>
